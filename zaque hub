-- Cria a GUI principal
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local ToggleButton = Instance.new("TextButton")
local DestroyButton = Instance.new("TextButton")
local ESPButton = Instance.new("TextButton")

-- Configurações da GUI principal
ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
ScreenGui.Name = "MainGui"
ScreenGui.ResetOnSpawn = false

MainFrame.Parent = ScreenGui
MainFrame.Name = "MainFrame"
MainFrame.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
MainFrame.Size = UDim2.new(0, 300, 0, 300)
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -150)
MainFrame.Active = true
MainFrame.Draggable = true

-- Configurações do botão de alternância (quadrado móvel)
ToggleButton.Parent = ScreenGui
ToggleButton.Name = "ToggleButton"
ToggleButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
ToggleButton.Size = UDim2.new(0, 50, 0, 50)
ToggleButton.Position = UDim2.new(0.9, -25, 0.1, -25)
ToggleButton.Text = "Toggle"
ToggleButton.Active = true
ToggleButton.Draggable = true

local guiVisible = true

-- Função para alternar a visibilidade do MainFrame
ToggleButton.MouseButton1Click:Connect(function()
    guiVisible = not guiVisible
    MainFrame.Visible = guiVisible
end)

-- Configurações do botão de destruir (no canto superior esquerdo do MainFrame)
DestroyButton.Parent = MainFrame
DestroyButton.Name = "DestroyButton"
DestroyButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
DestroyButton.Size = UDim2.new(0, 50, 0, 50)
DestroyButton.Position = UDim2.new(0, 0, 0, 0)
DestroyButton.Text = "Destroy"
DestroyButton.Active = true

-- Função para destruir a GUI
DestroyButton.MouseButton1Click:Connect(function()
    ToggleButton:Destroy()
    MainFrame:Destroy()
    DestroyButton:Destroy()
    ESPButton:Destroy()
    ScreenGui:Destroy()
end)

-- Configurações do botão ESP Players
ESPButton.Parent = MainFrame
ESPButton.Name = "ESPButton"
ESPButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
ESPButton.Size = UDim2.new(0, 100, 0, 50)
ESPButton.Position = UDim2.new(0, 60, 0, 0)
ESPButton.Text = "ESP Players Off"
ESPButton.Active = true

local espEnabled = false

-- Função para alternar o ESP Players
ESPButton.MouseButton1Click:Connect(function()
    espEnabled = not espEnabled
    if espEnabled then
        ESPButton.Text = "ESP Players On"
        -- Código para ativar o ESP
        for _, player in pairs(game.Players:GetPlayers()) do
            if player ~= game.Players.LocalPlayer then
                local espBox = Instance.new("BoxHandleAdornment")
                espBox.Name = "ESPBox"
                espBox.Adornee = player.Character
                espBox.Size = player.Character:GetExtentsSize()
                espBox.Color3 = Color3.fromRGB(255, 0, 0)
                espBox.Transparency = 0.5
                espBox.AlwaysOnTop = true
                espBox.ZIndex = 10
                espBox.Parent = player.Character
            end
        end
    else
        ESPButton.Text = "ESP Players Off"
        -- Código para desativar o ESP
        for _, player in pairs(game.Players:GetPlayers()) do
            if player.Character and player.Character:FindFirstChild("ESPBox") then
                player.Character:FindFirstChild("ESPBox"):Destroy()
            end
        end
    end
end)
