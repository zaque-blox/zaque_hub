local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local RunService = game:GetService("RunService")

-- Carregar a biblioteca Fluent
local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()

-- Criar a Janela Principal
local Window = Fluent:CreateWindow({
    Title = "zaque hub",
    TabWidth = 160,
    Size = UDim2.fromOffset(470, 360),
    Theme = "Darker"
})

-- Criar as abas
local Tabs = {
    Credits = Window:AddTab({ Title = "üåü Credits" }),
    Settings = Window:AddTab({ Title = "‚öôÔ∏è Settings" }),
    Main = Window:AddTab({ Title = "üõ†Ô∏è Main" }),
    Visual = Window:AddTab({ Title = "üòé Visual" }),
    Combate = Window:AddTab({ Title = "‚öîÔ∏è Combate" }),
}

-- Adicionando o nome do Criador na aba Credits
Tabs.Credits:AddParagraph({
    Title = "Criador", 
    Content = "feito somente por { zaque_blox - zaquel }"
})

-- Adicionando o nome "vers√£o" com o conte√∫do "2.0" na aba Credits
Tabs.Credits:AddParagraph({
    Title = "Vers√£o", 
    Content = "2.0"
})

-- Criar o bot√£o "Grupo do zap" na aba Credits
Tabs.Credits:AddButton({
    Title = "Grupo do zap",
    Description = "Clique para copiar o link do grupo do zap.",
    Callback = function()
        setclipboard("https://chat.whatsapp.com/CpJRk0pToQsKx94iKIm2a7")
    end
})

-- Adicionando apenas o t√≠tulo "Aim" na aba Combate
Tabs.Combate:AddParagraph({
    Title = "Aim", 
    Content = "sess√£o Aimbot"
})

-- Vari√°veis de controle
local camLockAtivo = false
local mirarNaCabecaAtivo = false

-- Fun√ß√£o para retornar a cor com base no time do jogador
local function getTeamColor(player)
    local team = player.Team
    if team then
        return team.TeamColor.Color  -- Retorna a cor do time
    else
        return Color3.fromRGB(255, 255, 255)  -- Branco para jogadores sem time (se n√£o tiver time definido)
    end
end

-- Fun√ß√£o para encontrar o inimigo mais pr√≥ximo **com vida** e de time diferente baseado na cor
local function encontrarInimigoMaisProximo()
    local nearestPlayer = nil
    local minDistance = math.huge

    for _, otherPlayer in pairs(game.Players:GetPlayers()) do
        if otherPlayer ~= player and otherPlayer.Character then
            local humanoid = otherPlayer.Character:FindFirstChild("Humanoid")
            
            -- Verifica se o jogador est√° no mesmo time (comparando as cores)
            if humanoid and humanoid.Health > 0 then
                local playerColor = getTeamColor(player)  -- Cor do time do jogador local
                local otherPlayerColor = getTeamColor(otherPlayer)  -- Cor do time do outro jogador
                
                -- Se as cores forem iguais, o jogador √© ignorado
                if playerColor == otherPlayerColor then
                    continue
                end

                local distance = (player.Character.HumanoidRootPart.Position - otherPlayer.Character.HumanoidRootPart.Position).magnitude
                if distance < minDistance then
                    minDistance = distance
                    nearestPlayer = otherPlayer
                end
            end
        end
    end

    return nearestPlayer
end

-- Fun√ß√£o do Aimbot
local function ativarAimbot()
    camLockAtivo = true
    RunService.RenderStepped:Connect(function()
        if camLockAtivo then
            local nearestPlayer = encontrarInimigoMaisProximo()
            
            if nearestPlayer and nearestPlayer.Character then
                local humanoid = nearestPlayer.Character:FindFirstChild("Humanoid")

                -- Verifica se o inimigo ainda est√° vivo
                if humanoid and humanoid.Health > 0 then
                    local camera = game.Workspace.CurrentCamera
                    local targetPart

                    -- Se "Head" estiver ativado, mira na cabe√ßa; sen√£o, mira no corpo
                    if mirarNaCabecaAtivo and nearestPlayer.Character:FindFirstChild("Head") then
                        targetPart = nearestPlayer.Character.Head
                    else
                        targetPart = nearestPlayer.Character:FindFirstChild("HumanoidRootPart")
                    end

                    if targetPart then
                        camera.CFrame = CFrame.new(camera.CFrame.Position, targetPart.Position)
                    end
                else
                    -- Se o jogador morreu, procura outro vivo automaticamente
                    nearestPlayer = encontrarInimigoMaisProximo()
                end
            end
        end
    end)
end

local function desativarAimbot()
    camLockAtivo = false
end

-- Toggle para ativar/desativar o Aimbot
Tabs.Combate:AddToggle("AimbotToggle", {
    Title = "Aimbot",
    Description = "Ative ou desative o Aimbot (bloqueio da c√¢mera no inimigo mais pr√≥ximo)",
    Default = false,
    Callback = function(state)
        if state then
            ativarAimbot()
        else
            desativarAimbot()
        end
    end
})

-- Toggle para ativar/desativar mira na cabe√ßa
Tabs.Combate:AddToggle("HeadToggle", {
    Title = "Head",
    Description = "Quando ativado, o Aimbot mira na cabe√ßa do inimigo mais pr√≥ximo",
    Default = false,
    Callback = function(state)
        mirarNaCabecaAtivo = state
    end
})

-- Fun√ß√µes ESP
local espAtivo = false
local espHealthBarAtivo = false
local espLineAtivo = false
local espHitboxAtivo = false
local espLines = {}
local espHitboxes = {}

-- Fun√ß√£o para criar ou atualizar a barra de vida
local function createOrUpdateHealthBar(player)
    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        if player.Character:FindFirstChild("HealthBar") then
            player.Character:FindFirstChild("HealthBar"):Destroy()
        end

        local healthBar = Instance.new("BillboardGui")
        healthBar.Name = "HealthBar"
        healthBar.Size = UDim2.new(4, 0, 0.6, 0)
        healthBar.StudsOffset = Vector3.new(0, 3, 0)
        healthBar.AlwaysOnTop = true
        healthBar.Adornee = player.Character:WaitForChild("HumanoidRootPart")
        healthBar.Parent = player.Character

        local barBackground = Instance.new("Frame")
        barBackground.Size = UDim2.new(1, 0, 1, 0)
        barBackground.BackgroundColor3 = Color3.new(0, 0, 0)
        barBackground.BorderSizePixel = 1
        barBackground.Parent = healthBar

        local bar = Instance.new("Frame")
        bar.Size = UDim2.new(player.Character.Humanoid.Health / player.Character.Humanoid.MaxHealth, 0, 1, 0)
        bar.BackgroundColor3 = Color3.new(0, 1, 0)
        bar.BorderSizePixel = 0
        bar.Parent = barBackground

        player.Character.Humanoid:GetPropertyChangedSignal("Health"):Connect(function()
            if player.Character and player.Character:FindFirstChild("Humanoid") then
                local healthPercentage = player.Character.Humanoid.Health / player.Character.Humanoid.MaxHealth
                bar.Size = UDim2.new(healthPercentage, 0, 1, 0)
            end
        end)
    end
end

-- Fun√ß√£o para ativar o ESP dos jogadores
local function ativarESPPlayer()
    espAtivo = true
    RunService.RenderStepped:Connect(function()
        if not espAtivo then return end
        for _, player in pairs(game.Players:GetPlayers()) do
            if player ~= game.Players.LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                if not player.Character:FindFirstChild("Highlight") then
                    -- Cria o Highlight para o jogador
                    local highlight = Instance.new("Highlight")
                    highlight.Adornee = player.Character
                    local teamColor = getTeamColor(player)  -- Obt√©m a cor do time do jogador
                    highlight.FillColor = teamColor
                    highlight.OutlineColor = teamColor
                    highlight.Parent = player.Character
                end
            end
        end
    end)
end

local function desativarESPPlayer()
    espAtivo = false
    for _, player in pairs(game.Players:GetPlayers()) do
        if player ~= game.Players.LocalPlayer and player.Character and player.Character:FindFirstChild("Highlight") then
            player.Character.Highlight:Destroy()
        end
    end
end

local function ativarESPHealthBar()
    espHealthBarAtivo = true
    RunService.Heartbeat:Connect(function()
        if espHealthBarAtivo then
            for _, player in pairs(game.Players:GetPlayers()) do
                if player ~= game.Players.LocalPlayer then
                    createOrUpdateHealthBar(player)
                end
            end
        end
    end)
end

local function desativarESPHealthBar()
    espHealthBarAtivo = false
    for _, player in pairs(game.Players:GetPlayers()) do
        if player ~= game.Players.LocalPlayer and player.Character and player.Character:FindFirstChild("HealthBar") then
            player.Character.HealthBar:Destroy()
        end
    end
end

local function ativarESPLine()
    espLineAtivo = true
    RunService.RenderStepped:Connect(function()
        if not espLineAtivo then return end
        for _, line in pairs(espLines) do
            if line then
                line:Destroy()
            end
        end
        table.clear(espLines)

        for _, target in pairs(game.Players:GetPlayers()) do
            if target ~= player and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
                local targetHRP = target.Character.HumanoidRootPart
                if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                    local playerHRP = player.Character.HumanoidRootPart
                    local line = Instance.new("Part")
                    line.Name = "ESPLine"
                    line.Size = Vector3.new(0.1, 0.1, (targetHRP.Position - playerHRP.Position).magnitude)
                    line.Anchored = true
                    line.CanCollide = false
                    line.Color = Color3.new(1, 0, 0) -- Vermelho
                    line.Material = Enum.Material.Neon
                    line.Transparency = 0.5
                    line.Parent = workspace
                    line.CFrame = CFrame.new((playerHRP.Position + targetHRP.Position) / 2, targetHRP.Position)
                    table.insert(espLines, line)
                end
            end
        end
    end)
end

local function desativarESPLine()
    espLineAtivo = false
    for _, line in pairs(espLines) do
        if line then
            line:Destroy()
        end
    end
    table.clear(espLines)
end

local function ativarESPHitbox()
    espHitboxAtivo = true
    for _, player in pairs(game.Players:GetPlayers()) do
        if player ~= game.Players.LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            -- Criando a hitbox inicialmente
            local humanoidRootPart = player.Character.HumanoidRootPart
            local hitbox = Instance.new("Part")
            hitbox.Name = "ESPHitbox"
            hitbox.Size = humanoidRootPart.Size + Vector3.new(2, 3, 2)  -- Ajuste no tamanho
            hitbox.Position = humanoidRootPart.Position
            hitbox.Anchored = true
            hitbox.CanCollide = false
            hitbox.Color = Color3.fromRGB(0, 255, 0)  -- Cor verde
            hitbox.Material = Enum.Material.SmoothPlastic
            hitbox.Transparency = 0.5  -- Transpar√™ncia 50%
            hitbox.Parent = workspace
            table.insert(espHitboxes, hitbox)

            -- Atualizando a posi√ß√£o da hitbox durante o jogo
            game:GetService("RunService").Heartbeat:Connect(function()
                if espHitboxAtivo and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                    hitbox.Position = player.Character.HumanoidRootPart.Position
                end
            end)
        end
    end
end

local function desativarESPHitbox()
    espHitboxAtivo = false
    for _, hitbox in pairs(espHitboxes) do
        if hitbox then
            hitbox:Destroy()
        end
    end
    table.clear(espHitboxes)
end


-- Bot√µes na Aba Visual
Tabs.Visual:AddToggle("EspPlayerToggle", {
    Title = "ESP Player",
    Description = "Ative ou desative a exibi√ß√£o dos jogadores",
    Default = false,
    Callback = function(state)
        if state then
            ativarESPPlayer()
        else
            desativarESPPlayer()
        end
    end
})

Tabs.Visual:AddToggle("EspHealthBarToggle", {
    Title = "ESP HealthBar",
    Description = "Ative ou desative a exibi√ß√£o das barras de vida",
    Default = false,
    Callback = function(state)
        if state then
            ativarESPHealthBar()
        else
            desativarESPHealthBar()
        end
    end
})

Tabs.Visual:AddToggle("EspLineToggle", {
    Title = "ESP Line",
    Description = "Ative ou desative as linhas de ESP entre voc√™ e os inimigos",
    Default = false,
    Callback = function(state)
        if state then
            ativarESPLine()
        else
            desativarESPLine()
        end
    end
})

Tabs.Visual:AddToggle("EspHitboxToggle", {
    Title = "ESP Hitbox",
    Description = "Ative ou desative as hitboxes para os jogadores",
    Default = false,
    Callback = function(state)
        if state then
            ativarESPHitbox()
        else
            desativarESPHitbox()
        end
    end
})
